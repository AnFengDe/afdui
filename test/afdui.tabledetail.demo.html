<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>AFDUI TableDetail Demo</title>
        <link rel="stylesheet" type="text/css" href="../libs/jqueryui/development-bundle/themes/start/jquery-ui.css">
        <link rel="stylesheet" type="text/css" href="../libs/jqueryui/development-bundle/themes/start/jquery.ui.theme.css">

        <script src="../libs/jqueryui/js/jquery-1.8.3.js"></script>
        <script src="../libs/jqueryui/js/jquery-ui-1.9.2.custom.js"></script>
        <script src="../libs/jquery.maskinput/jquery.maskedinput.min.js"></script>
        <script src="../libs/datatables/jquery.dataTables.js"></script>

        <!-- Load local lib and tests. -->
        <link rel="stylesheet" type="text/css" href="../libs/datatables/css/jquery.dataTables.css">
        <link rel="stylesheet" type="text/css" href="../src/afdui.tabledetail.css">
        <script src="../src/afdui.tabledetail.js"></script>
        <script charset="utf-8" src="../libs/datatables/fnAddDataAndDisplay.js"></script>

        <script>
			$(document).ready(function() {
				var lineData = null;
				$.ajax({
					type : "get",
					url : "info_line.json",
					dataType : "json",
					success : function(data) {
						lineData = data;
					},
					async : false
				});
				var td = $('#tblDetail').tabledetail({
					"width" : 1000,
					"height" : 540,
					"table" : {
						"sScrollY" : "220px",
						"iDisplayLength" : 10,
						"aoColumns" : [{
							"sTitle" : "ID",
							"mData" : "id",
							"sWidth" : "15%"
						}, {
							"sTitle" : "Name",
							"mData" : "name",
							"sWidth" : "50%"
						}, {
							"sTitle" : "Alias",
							"mData" : "alias",
							"sWidth" : "20%"
						}, {
							"sTitle" : "Voltage Level",
							"mData" : "voltageLevel",
							"sWidth" : "15%"
						}]
					},
					"form" : {
						"pages" : [{
							"title" : "General Info",
							"rows" : 2,
							"cols" : 4,
							"controls" : [{
								"label" : "ID",
								"id" : "id",
								"type" : "input",
								"format" : "number",
								"read" : false,
								"maxlength" : 10,
								"size" : 10
							}, {
								"label" : "Name",
								"id" : "name",
								"type" : "input",
								"format" : "text",
								"read" : false,
								"maxlength" : 32,
								"size" : 32,
								"validator" : function(value) {
									return (1 <= value.length && value.length <= 32);
								},
								"customData" : function() {
									return '2400000';
								},
								"message" : "The length between in 1 - 32"
							}, {
								"label" : "Alias",
								"id" : "alias",
								"type" : "input",
								"format" : "text",
								"read" : false,
								"maxlength" : 4,
								"size" : 4,
								"mask" : "9999",
								"validator" : function(value) {
									return (1 <= value.length && value.length <= 4 && !isNaN(Number(value) / 1));
								},
								"message" : "Numeric length between in 1 - 4"
							}, {
								"label" : "Voltage Level",
								"id" : "voltageLevel",
								"type" : "select",
								"format" : "text",
								"options" : [{
									"id" : "1",
									"name" : "500kV"
								}, {
									"id" : "2",
									"name" : "220kV"
								}, {
									"id" : "3",
									"name" : "110kV"
								}],
								"read" : false,
								"maxlength" : 16,
								"size" : 16
							}]
						}, {
							"title" : "Topo Info",
							"rows" : 1,
							"cols" : 4,
							"controls" : [{
								"label" : "Start Substation",
								"id" : "startSubstationID",
								"type" : "select",
								"format" : "number",
								"options" : "info_substation.json",
								"read" : false,
								"maxlength" : 16,
								"size" : 20
							}, {
								"label" : "End Substation",
								"id" : "endSubstationID",
								"type" : "select",
								"format" : "number",
								"options" : "info_substation.json",
								"read" : false,
								"maxlength" : 16,
								"size" : 20
							}]
						}]
					},
					"hoverTr" : function(e, ui) {
						if (e.handleObj.origType === "mouseenter") {
							ui.thistr.style.color = 'red';
						} else {
							ui.thistr.style.color = 'black';
						}

					},
					"clickTr" : function(e, ui) {
						ui.thistr.style.color = 'black';
					}
				});
				td.tabledetail("addData", lineData);
				td.tabledetail("remoteAjax", {
					"create" : "/powerflow/api/config/devices/buses/new",
					"edit" : "/powerflow/api/config/devices/buses/_name_",
					"remove" : "/powerflow/api/config/devices/buses/_id_"
				});
				var callback = function(obj) {
					if (obj.id.value === obj.name.value) {
						return 'the values of id is can\'t the same as the values of name!';
					}
				}
				var callback2 = function(data) {
					for (var i = 0; i < data.length; i++) {
						for (var j = i + 1; j < data.length; j++) {
							if (data[i].id === data[j].id) {
								return 'can\'t the repeat id!' + data[i].id;
							}
						}
					}
				}
				td.tabledetail("validatorForm", callback);
				td.tabledetail("validatorTable", callback2);
			});

        </script>
    </head>
    <body>
        <div id="tblDetail" title="TableDetail Demo Page"></div>
    </body>
</html>
